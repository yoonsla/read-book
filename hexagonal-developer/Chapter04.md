# 코드 이해

## 코드 변경

개발자가 코드를 변경할 때 다음 2단계 과정을 거친다. 

- 코드 이해
- 코드 수정

### 코드 이해

개발자가 코드를 변경하기 위해 코드를 이해하는 데 개발 시간의 60%를 쓴다고 한다.
버그 수정과 같은 작업은 코드를 이해하는 데 90% 이상의 시간을 쏟기도 한다.

코드를 이해하는 시간을 줄이기 위해서는 2가지 역량이 요구된다.

첫 번째는 코드를 데대로 이해할 수 있는 역량이 필요하다.
또 다른 하나는 이해하기 쉬운 코드를 작성하는 역량이다.
품질이 낮은 스파게티 코드를 이해하기 위해서는 품질이 좋은 코드보다 40% 정도 더 많은 시간이 소요된다고 한다.

그래서 이해하기 좋은 코드를 만들면 코드를 이해하는 데 들어가는 시간을 줄일 수 있으며 결과적으로 개발 시간도 줄어든다.

## 코드 이해 도구

코드 분석에 도움이 되는 다양한 수단이 존재한다.

### 코드 시각화

코드를 분석하고 그 결과를 그림으로 그리면 수정할 위치나 수정 영향을 받는 범위를 찾을 때 큰 도움이 된다.  
자신만의 표기법을 사용해도 되지만, 그렇게되면 다른 사람과의 의사소통에서 서로 다르게 해석 될 수 있는 여지가 있어, UML을 사용하는 것을 권장한다.

### 코드 출력

A3 용지같이 큰 종이에 코드를 출력하여 관심있는 코드에 형광펜으로 칠하고 서로 영향을 주는 코드는 서로 선을 긋는 등의 행동을 하면
나중에 다시 출력물을 볼 때 기억을 되살리는 데 도움을 준다.

### 스크래치 리팩터링

스크래치 리팩터링은 코드 분석을 목적으로 하는 리팩터링이다.
리팩터링을 하면 변수 이름 변경, 메서드 추출, 클래스 추출, 파라미터 타입 변경과 같은 수정을 하게 되는데
이런 작업을 진행하면서 코드 동작을 깊이 이해할 수 있게 된다.

스크래치 리팩터링은 코드 개선이 아닌 코드 이해가 목적이므로 리팩터링한 결과는 반영하지 하고 다시 원래대로 되돌린다.

### 함께 모여 보기

코드를 함께 보면 다음과 같은 이점이 있다.

- 코드에 대한 지식이 여러 명에게 쌓이다.
- 서로의 지식을 주고 받으며 부족한 부분을 채울 수 있다.
- 잘못 이해하는 것을 줄일 수 있다.

함께 모여서 코드를 볼 때는 2 ~ 4명 정도가 적당하다.  
참여 인원이 늘어나면 대화가 분산되면서 개개인의 집중력과 참여 적극성이 떨어질 수 있기 때문이다.

## 이해하기 좋은 코드

다양한 도구를 사용하여 코드를 이해하는 역량을 높이는 것은 코드 분석에 도움이 된다.  
하지만 더 중요한 것은 코드 자체를 이해하기 쉽게 만드는 것이다.
이해하기 쉬운 코드의 기본은 가독성이 좋은 코드다.

### 이해를 돕는 몇 가지 코드 작성법

다음은 가독성 좋은 코드를 작성하기 위해 알고 있어야 하는 것들이다.

#### 이름

가독성이 좋은 코드를 작성하기 위한 출발점은 올바른 이름을 선택하는 것부터 시작된다.
의미나 의도 또는 목적을 유추할 수 있는 이름을 사용해야 한다.
표기한 이름이 실제 역할과 다르다면 코드를 분석할 때 혼란을 준다.
이름은 짧을수록 좋지만 사용 범위가 넓다면 서술적인 이름을 사용해야 한다.

### 중첩 if 최소화 

복잡한 if-else 문은 코드 분석을 어렵게 만드는 요인 중 하나다.

```java
if (조건A) {
    ...코드 1
    if (조건 B) {
        ..코드 2
        if (조건 C) {
            ...코드 3 // 조건 A,B,C를 추적해야 함    
        } 
    } else {
        ...코드 4 // B 조건이 아닐 때 실행        
    }
}
```

if 문이 중첩되어 코드가 복잡할 때는 if 조건을 역으로 바꿔 코드 구조를 단순화 할 수 있다.

```java
if (조건) {
    ...스크롤이 필요한 꽤 긴 코드
}
return;
```

위의 if 구조는 아래와 같이 변경 할 수 있다.

```java
if (!조건) {
    return;
}
...스크롤이 필요한 꽤 긴 코드
```

#### 변수 줄이기

변수로 인한 인지 부하를 낮추려면 변수 자체를 줄여야 한다.

변수 사용 범위는 최댜한 좁게 한정하자.
변수를 사용하는 범위가 넓어질수록 변수를 추적하기가 어려워진다.
다음고 같은 규칙으로 적절한 변수 사용 범위를 정할 수 있다.

- 사용되기 직전에 정의
- 짧은 루프 블록 안으로 한정
- 짧은 if-else 블록 안으로 한정
- 짧은 메서드로 한정

#### 값 변경 최소화하기

변숫값이 중간에 계속해서 바뀌면 코드를 분석할 때 해당 변수에 담긴 값을 추적해야 한다는 부담이 생긴다.
언어가 제공하는 요소의 특성을 잘 활용하면 데이터가 바뀌지 않는다는 것을 명확하게 표현할 수 있다.
예를들어 const나 final과 같은 키워드를 사용하면 변수가 바뀌지 않는다는 것을 보장할 수 있다.
또한 자바 레코드 타입이나 코틀린의 데이터 클래스를 사용하면 불변 객체를 쉽게 만들 수 있다.

파라미터 값 변경도 최소화 하자. 파라미터로 전달받은 값을 변경하면 함수를 호출한 코드를 분석할 때 어려움을 겪는다.

#### 알맞은 파라미터 타입 사용하기

개발과 유지보수가 진행됨에 따라 여러 메서드가 하나의 타입을 공유하는 방식은 코드 분석을 어렵게 만든다.
이해하기 좋은 코드를 만들려면 메서드를 실행하는 데 필요한 값만 파라미터로 전달해야 한다.

필요한 값만 갖는 타입을 추가하다 보면 만들어야 할 타입이 늘어난다.
타입이 늘어나면 복잡도도 올라간다.
새로운 타입을 만들어야 하니 귀찮기도 하다.
하지만, 타입을 추가했을 때 올라가는 코드 복잡도보다 하나의 타입을 여러 메서드의 파라미터 타입으로 사용하면서 늘어나는 코드 분석 시간이 더 큰 문제다.

#### 길지 않은 코드와 메서드 추출

클래스, 메서드, 함수가 길면 머리에 담아야 할 내용이 많아지고 코드 분석은 힘들어진다.  
메서드나 함수를 길지 않게 만들려면 모든 구현을 한 메서드에 넣으면 안된다. 대신 구현의 일부를 별도 메서드나 객체로 분리해야 한다.

길지 않은 코드는 결국 추상화 수준을 맞추는 것과 연결된다.

#### 추상화 수준 맞추기

추상화 수준이란 코드를 읽으면서 파악할 수 있는 정보의 수준을 말한다.  
추상화 수준이 들쑥날쑥하면 코드를 분석할 때 개발자가 해석하는 과정을 거쳐야한다.
따라서 이해하기 좋은 코드를 만들려면 최대한 한 메서드 내에서 코드가 표현하는 추상화 수준을 맞추려고 노력해야 한다.



















